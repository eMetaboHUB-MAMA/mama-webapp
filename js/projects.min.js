var nbProjectsWaiting=0;var nbProjectsCompleted=0;var nbProjectsAccepted=0;var nbProjectsAssigned=0;var nbProjectsRunning=0;var nbProjectsArchived=0;var nbProjectsBlocked=0;var nbProjectsRejected=0;var nbProjectsTotal=0;var nbProjectsTotalWaiting=0;var nbProjectsTotalCompleted=0;var nbProjectsTotalAccepted=0;var nbProjectsTotalAssigned=0;var nbProjectsTotalRunning=0;var nbProjectsTotalArchived=0;var nbProjectsTotalBlocked=0;var nbProjectsTotalRejected=0;var nbProjectsTotalTotal=0;var nbProjectsInChargeWaiting=0;var nbProjectsInChargeCompleted=0;var nbProjectsInChargeAccepted=0;var nbProjectsInChargeAssigned=0;var nbProjectsInChargeRunning=0;var nbProjectsInChargeTotal=0;var projectsManagers=[];var currentStatus=null;var currentStart=0;var currentLimit=20;var currentKeyword=null;var filterInCharge=false;var filterInvolved=false;var filterOwner=false;var currentProjectId=null;var filterMthPF=false;var filterMthPFval="";$(document).ready(function(){loadLang();if(getUrlParameter("status")!==undefined&&getUrlParameter("status")!="null"){currentStatus=getUrlParameter("status");$("#search-analyses-filter-status").html($("#aPj_"+currentStatus).html())}if(getUrlParameter("keyword")!==undefined){currentKeyword=getUrlParameter("keyword");$("#projectsSearchFilter").val(currentKeyword)}if(getUrlParameter("start")!==undefined){currentStart=getUrlParameter("start")}if(getUrlParameter("limit")!==undefined){currentLimit=getUrlParameter("limit")}if(getUrlParameter("userFilter")!==undefined){if(getUrlParameter("userFilter")=="inCharge"){filterInCharge=true;$("#btn-userFilter-inCharge").removeClass("btn-default").addClass("btn-primary")}else{if(getUrlParameter("userFilter")=="involved"){filterInvolved=true;$("#btn-userFilter-involved").removeClass("btn-default").addClass("btn-primary")}else{if(getUrlParameter("userFilter")=="owner"){filterOwner=true;$("#btn-userFilter-owner").removeClass("btn-default").addClass("btn-primary")}}}}if(getUrlParameter("mth_pf")!==undefined){filterMthPF=true;filterMthPFval=getUrlParameter("mth_pf")}loadProjectsStats();projectsManagers=getAllProjectsManagers();var a="user";if(userData.right=="admin"||userData.right=="project_manager"){a="pm";$("#mthPlatforms").append('<option selected value=""> - </option>');buildMTHplatforms();buildRangeDate()}$.get("templates/projects-full-list-"+a+"-template-"+lang+".html",function(b){$("body").append(b);loadProjectsList(currentStart,currentLimit,currentStatus)});$("#projectsSearchFilter").bind("keypress",function(c){var b=c.keyCode||c.which;if(b==13){searchProjects()}});$("#link-donwload-xls-file").attr("href",$("#link-donwload-xls-file").attr("href")+document.location.search.replace("?page=projects",""))});function loadProjectsStats(){var d="get";var b="projects-stats";var a="";var c=false;if(currentKeyword!=null){a+="&keywords="+currentKeyword;c=true}if(filterInCharge){a+="&userFilter=inCharge";c=true}else{if(filterInvolved){a+="&userFilter=involved";c=true}else{if(filterOwner){a+="&userFilter=owner";c=true}}}if($("#range-date-start").val()!=""&&$("#range-date-start").val()!==undefined){a+="&from="+$("#range-date-start").val();c=true}else{if((getUrlParameter("from")!==undefined)){a+="&from="+getUrlParameter("from");c=true}}if($("#range-date-end").val()!=""&&$("#range-date-end").val()!==undefined){a+="&to="+$("#range-date-end").val();c=true}else{if((getUrlParameter("to")!==undefined)){a+="&to="+getUrlParameter("to");c=true}}if((getUrlParameter("mth_pf")!==undefined)){a+="&mth_pf="+getUrlParameter("mth_pf");c=true}$.ajax({type:"get",url:"ajax/ajax_proxypass.php?verbe="+d+"&resource="+b+a,dataType:"json",async:true,success:function(e){if(e.hasOwnProperty("success")&&e.success==false){}else{if(e.userRight=="project_manager"||e.userRight=="admin"){nbProjectsWaiting=e.allProjectsWaiting;nbProjectsCompleted=e.allProjectsCompleted;nbProjectsAccepted=e.allProjectsAccepted;nbProjectsAssigned=e.allProjectsAssigned;nbProjectsRunning=e.allProjectsRunning;nbProjectsArchived=e.allProjectsArchived;nbProjectsBlocked=e.allProjectsBlocked;nbProjectsRejected=e.allProjectsRejected}else{nbProjectsWaiting=e.userProjectsWaiting;nbProjectsCompleted=e.userProjectsCompleted;nbProjectsAccepted=e.userProjectsAccepted;nbProjectsAssigned=e.userProjectsAssigned;nbProjectsRunning=e.userProjectsRunning;nbProjectsArchived=e.userProjectsArchived;nbProjectsBlocked=e.userProjectsBlocked;nbProjectsRejected=e.userProjectsRejected}nbProjectsTotal=nbProjectsWaiting+nbProjectsCompleted+nbProjectsAccepted+nbProjectsAssigned+nbProjectsRunning+nbProjectsArchived+nbProjectsBlocked+nbProjectsRejected;if(nbProjectsTotal==0&&!c){$("#noProjectsContent").show();$(".listProjectsContent").hide()}}},error:function(e){console.log(e)}})}function loadProjectsList(g,b,a){$("#projects-full-list-container").empty();var f="get";var d="projects";var e=false;var c="&start="+g+"&limit="+b;if(a!==undefined&&a!==null){c+="&status="+a;e=true}if(currentKeyword!=null){c+="&keywords="+currentKeyword;e=true}if(filterInCharge){c+="&userFilter=inCharge";e=true}else{if(filterInvolved){c+="&userFilter=involved";e=true}else{if(filterOwner){c+="&userFilter=owner";e=true}}}if($("#range-date-start").val()!=""&&$("#range-date-start").val()!==undefined){c+="&from="+$("#range-date-start").val();e=true}else{if((getUrlParameter("from")!==undefined)){c+="&from="+getUrlParameter("from");e=true}}if($("#range-date-end").val()!=""&&$("#range-date-end").val()!==undefined){c+="&to="+$("#range-date-end").val();e=true}else{if((getUrlParameter("to")!==undefined)){c+="&to="+getUrlParameter("to");e=true}}if($("#mthPlatforms").val()!=""&&$("#mthPlatforms").val()!==undefined){c+="&mth_pf="+$("#mthPlatforms").val();e=true}else{if((getUrlParameter("mth_pf")!==undefined)){c+="&mth_pf="+getUrlParameter("mth_pf");e=true}}c+="&order=desc";$.ajax({type:"get",url:"ajax/ajax_proxypass.php?verbe="+f+"&resource="+d+c,dataType:"json",async:true,success:function(j){if(j!=null&&j.hasOwnProperty("success")&&j.success==false){}else{if(j.length===0&&(!e)){$("#noProjectsDiv").show();$("#tableListProjects").hide()}else{$("#noProjectsDiv").hide();$.each(j,function(){this["titleAlt"]=((this["title"]).replace(/'/g,"\\'"));this["createdLocalDate"]=convertJsonDateToHumanReadableShort(this.created.date);if(this.updated!=null){this["updatedLocalDate"]=convertJsonDateToHumanReadableShort(this.updated.date)}this["listOfPM"]=projectsManagers;var k="";$.each(this.analystsInvolved,function(m,l){if(k!=""){k+=", "}k+=""+l.fullName});this["analystsInChargeList"]=k});$("#projects-full-list-template").tmpl(j).appendTo("#projects-full-list-container");$(".multiselect").multiselect({enableFiltering:true,enableCaseInsensitiveFiltering:true,filterPlaceholder:"search...",maxHeight:500,numberDisplayed:2,buttonWidth:"100px"});var i=$("#contextMenu");$("body").on("click",".context-menu-pj",function(k){currentProjectId=Number($(this).attr("id").replace("btn-action-",""));i.css({display:"block",left:k.pageX-150,top:k.pageY});return false});$("body").on("click",function(){i.hide();currentProjectId=null});var h=nbProjectsTotal;if(a=="blocked"){h=nbProjectsBlocked}else{if(a=="rejected"){h=nbProjectsRejected}else{if(a=="waiting"){h=nbProjectsWaiting}else{if(a=="assigned"){h=nbProjectsAssigned}else{if(a=="accepted"){h=nbProjectsAccepted}else{if(a=="completed"){h=nbProjectsCompleted}else{if(a=="running"){h=nbProjectsRunning}else{if(a=="archived"){h=nbProjectsArchived}}}}}}}}if(h>b){buildPagination(g,b,a,"projectsPagination","loadProjectsList",h)}}}},error:function(h){console.log(h)}})}var currentProjectInModalId=null;function showProject(a){$("#showMoreEventsBtn").show();var c="get";var b="project&projectID="+a;$.ajax({type:"get",url:"ajax/ajax_proxypass.php?verbe="+c+"&resource="+b,dataType:"json",async:true,success:function(i){if(i!==null&&i.hasOwnProperty("success")&&i.success==false){}else{$.each(i,function(l,e){$("#project-"+l).html(e)});$("#project-owner").html(i.owner.fullName);$("#project-owner-email").html(i.owner.email);currentProjectInModalId=i.id;$("#project-demand .label").hide();$("#trSampleNb .label").hide();$("#trSampleNb").hide();if(i.demandTypeCatalogAllowance){$(".demandTypeCatalogAllowance").show();$("#trSampleNb").show();if(i.samplesNumber!==null){$(".project-sampleNumber-"+i.samplesNumber.replace(/ /g,"_")).show()}}if(i.demandTypeEqProvisioning){$(".demandTypeEqProvisioning").show()}if(i.demandTypeFeasibilityStudy){$(".demandTypeFeasibilityStudy").show()}if(i.demandTypeTraining){$(".demandTypeTraining").show()}if(i.demandTypeDataProcessing){$(".demandTypeDataProcessing").show()}if(i.demandTypeOther){$(".demandTypeOther").show()}var f="";$.each(i.thematicWords,function(l,e){f+='<span class="label label-default">'+e.word+"</span>&nbsp;"});$("#trKeyWords").html(f);var g="";$.each(i.subThematicWords,function(l,e){g+='<span class="label label-default">'+e.word+"</span>&nbsp;"});$("#trSubKeyWords").html(g);var d="";$.each(i.mthPlatforms,function(l,e){d+='<span class="label label-default">'+e.name+"</span>&nbsp;"});$("#trPlatforms").html(d);if(i.scientificContextFile!==null&&i.scientificContextFile!==""){$("#project-scientificContextFile").parent().show();var j='<a href="'+i.scientificContextFileURL+'" target="_blank">'+i.scientificContextFile+"</a>";$("#project-scientificContextFile").html(j)}else{$("#project-scientificContextFile").parent().hide();$("#project-scientificContextFile").html("")}$(".trBlockedOrRejected").hide();if(i.status=="rejected"&&i.hasOwnProperty("analysisRequestExtraData")){$(".trRejected").show();try{switch(i.analysisRequestExtraData.rejectedReason){case"too_expensive":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_expensive);break;case"too_long_delays":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_delays);break;case"outside_our_skill_sphere":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_outside_our_skill);break;case"non_prioritary_rad":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_non_prioritary);break;case"incompatible_deadline":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_incompatible_deadline);break;case"too_many_samples":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_too_many_samples);break;case"transfered_to_privilegied_mth_partner":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_transfered_to_privilegied);break;case"not_funded":$("#trRejected").html(_modal_stopProject_rejectedSelect_opt_not_funded);break}}catch(h){}$("#trStopped").html(i.analysisRequestExtraData.stoppedReason)}else{if(i.status=="blocked"&&i.hasOwnProperty("analysisRequestExtraData")){$(".trBlocked").show();try{switch(i.analysisRequestExtraData.blockedReason){case"waiting_for_samples":$("#trBlocked").html(_modal_stopProject_pausedSelect_opt_waiting_for_samples);break;case"waiting_for_service_user_answer":$("#trBlocked").html(_modal_stopProject_pausedSelect_opt_waiting_for_service_user_answer);break;case"waiting_for_provisioning":$("#trBlocked").html(_modal_stopProject_pausedSelect_opt_waiting_for_provisioning);break}}catch(h){}$("#trStopped").html(i.analysisRequestExtraData.stoppedReason)}}$("#projectModal").modal("show");lastProjectId=i.id;lastEventStart=0;lastEventLimit=10;$("#events-light-list-container").empty();$.get("templates/events-light-list-template-"+lang+".html",function(e){$("body").append(e);loadProjectEventsList(0,10,i.id)});lastMessageStart=0;lastMessageLimit=10;$("#messages-light-list-container").empty();$.get("templates/messages-light-list-inPjModal-template-"+lang+".html",function(e){$("body").append(e);loadProjectMessagesList(0,10,i.id)});$("#divWriteProjectMessage").parent().show();$("#divWriteProjectMessage").empty().append('<textarea id="writeProjectMessage" class="form-control wysihtml5" rows="3"></textarea>');$("#writeProjectMessage").wysihtml5({"font-styles":false,emphasis:true,lists:false,html:false,link:false,image:false,color:false,blockquote:false});$("a[title='Indent']").remove();$("a[title='Outdent']").remove();$("a[title='CTRL+S']").remove();setTimeout(function(){$($(".wysihtml5-toolbar")[0]).append('<li class="pull-right"><small id="writeProjectMessageCount"></small></li>');setInterval(function(){$("#writeProjectMessageCount").html(2048-$("#writeProjectMessage").val().length)},100)},250);$("#writeProjectMessageBtn").attr("onclick","postMessageToProject("+i.id+");")}},error:function(d){console.log(d)}})}editProject=function(a){document.location="?page=edit-project&editProject="+a};function loadProjectEventsList(f,b,a){var e="get";var d="events";var c="&start="+f+"&limit="+b;c+="&filter=projects&projectID="+a;c+="&order=desc";$.ajax({type:"get",url:"ajax/ajax_proxypass.php?verbe="+e+"&resource="+d+c,dataType:"json",async:true,success:function(h){if(h.hasOwnProperty("success")&&h.success==false){}else{if(h.length===0){$("#showMoreEventsBtn").hide()}else{if(h.length<b){$("#showMoreEventsBtn").hide()}$("#noEventToShow").hide();var g=new Date();$.each(h,function(j,i){i=eventStatUpdate(i,g)});$("#events-light-list-template").tmpl(h).appendTo("#events-light-list-container");$('[data-toggle="tooltip"]').tooltip()}}},error:function(g){console.log(g)}})}var lastProjectId=-1;var lastEventStart=0;var lastEventLimit=10;function showMoreProjectEvents(){lastEventStart+=lastEventLimit;loadProjectEventsList(lastEventStart,lastEventLimit,lastProjectId)}function updateInCharge(a){var c="put";var b="project";$.ajax({type:"post",url:"ajax/ajax_proxypass.php?verbe="+c+"&resource="+b+"&projectID="+a,dataType:"json",data:"analystInCharge="+Number($("#projectTr"+a+" .btn-mini").val()),async:true,success:function(d){if(d.hasOwnProperty("success")&&d.success==false){}else{if($("#projectTr"+a).hasClass("waiting")){$("#projectTr"+a).removeClass("waiting");$("#projectTr"+a).addClass("assigned")}}},error:function(d){console.log(d)}})}function updateInvolved(a,b){var d="put";var c="project";$.ajax({type:"post",url:"ajax/ajax_proxypass.php?verbe="+d+"&resource="+c+"&projectID="+a,dataType:"json",data:"analystsInvolved="+(b),async:true,success:function(e){if(e.hasOwnProperty("success")&&e.success==false){}else{}},error:function(e){console.log(e)}})}function reloadPage(a){var b="?page=projects";if(a!==undefined){b+="&status="+a}else{if(currentStatus!==null){b+="&status="+currentStatus}}if(filterInCharge){b+="&userFilter=inCharge"}else{if(filterInvolved){b+="&userFilter=involved"}else{if(filterOwner){b+="&userFilter=owner"}}}if($("#projectsSearchFilter").val().trim()!=""){b+="&keyword="+$("#projectsSearchFilter").val().trim()}if(filterMthPF){b+="&mth_pf="+filterMthPFval}if($("#range-date-start").val()!=""){b+="&from="+$("#range-date-start").val()}if($("#range-date-end").val()!=""){b+="&to="+$("#range-date-end").val()}document.location=b}function searchProjects(){reloadPage(currentStatus)}function addRemoveUserFilter(a,c){var b="?page=projects";if(a=="inCharge"&&!filterInCharge){b+="&userFilter=inCharge"}else{if(a=="involved"&&!filterInvolved){b+="&userFilter=involved"}else{if(a=="owner"&&!filterOwner){b+="&userFilter=owner"}}}if(currentStatus!==null){b+="&status="+currentStatus}if($("#projectsSearchFilter").val().trim()!=""){b+="&keyword="+$("#projectsSearchFilter").val().trim()}if(a=="mth_pf"){b+="&mth_pf="+c;if(filterInCharge){b+="&userFilter=inCharge"}else{if(filterInvolved){b+="&userFilter=involved"}else{if(filterOwner){b+="&userFilter=owner"}}}}else{if(filterMthPF){b+="&mth_pf="+filterMthPFval}}if($("#range-date-start").val()!=""){b+="&from="+$("#range-date-start").val()}if($("#range-date-end").val()!=""){b+="&to="+$("#range-date-end").val()}document.location=b}function setProjectStatus(a,b){var d="put";var c="project";$.ajax({type:"post",url:"ajax/ajax_proxypass.php?verbe="+d+"&resource="+c+"&projectID="+a,dataType:"json",data:"status="+b,async:true,success:function(e){if(e.hasOwnProperty("success")&&e.success==false){}else{$(".btn-pj-"+a).hide();$("#projectTr"+a).removeClass("waiting");$("#projectTr"+a).removeClass("assigned");$("#projectTr"+a).removeClass("accepted");$("#projectTr"+a).removeClass("completed");$("#projectTr"+a).removeClass("running");$("#projectTr"+a).removeClass("archived");$("#projectTr"+a).removeClass("blocked");$("#projectTr"+a).removeClass("rejected");$("#projectTr"+a).addClass(b);if(b=="blocked"||b=="rejected"){blockProject(a,b)}}},error:function(e){console.log(e)}})}function loadProjectMessagesList(f,b,a){var e="get";var d="messages";var c="&start="+f+"&limit="+b;c+="&projectID="+a;c+="&order=desc";$.ajax({type:"get",url:"ajax/ajax_proxypass.php?verbe="+e+"&resource="+d+c,dataType:"json",async:true,success:function(h){if(h.hasOwnProperty("success")&&h.success==false){}else{if(h.length===0){$("#showMoreMessageBtn").hide()}else{if(h.length<b){$("#showMoreMessageBtn").hide()}$("#noMessageToShow").hide();var g=new Date();$.each(h,function(j,i){i.messageClean=$("<div>").append(i.message).text().replace('"',"&quot;");i=eventStatUpdate(i,g)});$("#messages-light-list-template").tmpl(h).appendTo("#messages-light-list-container");$('[data-toggle="tooltip"]').tooltip()}}},error:function(g){console.log(g)}})}var lastMessageStart=0;var lastMessageLimit=10;showMoreProjectMessages=function(){lastMessageStart+=lastEventLimit;loadProjectMessagesList(lastMessageStart,lastMessageLimit,lastProjectId)};function buildRangeDate(){if(getUrlParameter("from")!==undefined){$("#range-date-start").val(getUrlParameter("from"))}if(getUrlParameter("to")!==undefined){$("#range-date-end").val(getUrlParameter("to"))}$(document).ready(function(){$(".datepicker").datepicker()})}$("#range-date-update").bind("click",function(a){reloadPage()});function blockProject(b,a){$(".blockedOrRejectedCase").hide();if(a=="blocked"){$("#blockedCase").show();$(".blockedCase").show();$("#blockedCase_list").val("")}else{if(a=="rejected"){$("#rejectedCase").show();$(".rejectedCase").show();$("#rejectedCase_list").val("")}}$("#blockedOrRejectedCase_txt").html("");$("#blockedOrRejectedCase_txt").val("");$("#closeBlockedModalBtn").attr("onclick","closeBlockedModal("+b+");");$("#blockedModal").modal("show")}function closeBlockedModal(a){var c="put";var b="stop-project";$.ajax({type:"post",url:"ajax/ajax_proxypass.php?verbe="+c+"&resource="+b+"&projectID="+a,dataType:"json",data:"blockedCase="+($("#blockedCase_list").val())+"&rejectedCase="+($("#rejectedCase_list").val())+"&stoppedReason="+(encodeURIComponent($("#blockedOrRejectedCase_txt").val())),async:true,success:function(d){if(d.hasOwnProperty("success")&&d.success==false){}else{$("#blockedModal").modal("hide")}},error:function(d){console.log(d)}})}function printProject(a){var d="";d+='<meta charset="utf-8">';d+='<meta http-equiv="X-UA-Compatible" content="IE=edge">';d+='<meta name="viewport" content="width=device-width, initial-scale=1">';d+='<meta name="description" content="">';d+='<meta name="author" content="MetaboHUB">';d+="<title>MAMA - MetaboHUB Analyses MAnager</title>";d+='<link rel="icon" type="image/ico" href="images/ico/favicon.ico">';d+='<script src="js/jquery-2.1.4.min.js"><\/script>';d+='<script src="js/jquery.tmpl.min.js"><\/script>';d+='<link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">';d+='<link href="bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">';d+='<link href="dist/css/timeline.min.css" rel="stylesheet">';d+='<link href="dist/css/sb-admin-2.min.css" rel="stylesheet">';d+='<link href="dist/css/sb-admin-2.overwrite.min.css" rel="stylesheet">';d+='<link href="bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">';d+='<script src="dist/js/sb-admin-2.min.js"><\/script>';d+='<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"><\/script>';d+='<script src="bower_components/metisMenu/dist/metisMenu.min.js"><\/script>';d+='<link href="dist/css/bootstrap-datepicker.min.css" media="screen" rel="stylesheet" type="text/css">';d+='<script src="dist/js/bootstrap-datepicker.min.js" type="text/javascript"><\/script>';d+='<link rel="stylesheet" type="text/css" href="dist/bootstrap3-wysihtml5.min.css">';d+='<script src="dist/bootstrap3-wysihtml5.all.min.js"><\/script>';d+="<!--[if lt IE 9]>";d+='	<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"><\/script>';d+='	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"><\/script>';d+="<![endif]-->";d+='<script src="js/jquery.localisation.min.js" type="text/javascript"><\/script>';d+='<script type="text/javascript" src="dist/js/bootstrap-multiselect.js"><\/script>';d+='<link rel="stylesheet" href="dist/css/bootstrap-multiselect.min.css" type="text/css">';d+='<script type="text/javascript" src="bower_components/moment/moment.min.js"><\/script>';d+='<script type="text/javascript" src="bower_components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"><\/script>';d+='<link rel="stylesheet" href="bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css">';d+='<script src="js/main.min.js" type="text/javascript"><\/script>';d+='<script src="js/commons.min.js" type="text/javascript"><\/script>';d+='<script src="js/md5.min.js" type="text/javascript"><\/script>';d+='<link href="css/mama-css.overwrite.min.css" media="screen" rel="stylesheet" type="text/css">';var b='<script type="text/javascript">';b+='$(".modal-footer").hide();';b+='$(".panel-collapse.collapse").removeClass("collapse");';b+='$("#divWriteProjectMessage").parent().hide();';b+='$($(".panel-collapse.collapse")[0]).parent().find("a").click()';if(a){b+='$("#collapseProjectEvents").parent().hide();';b+='$("#collapseProjectMessages").parent().hide();'}b+="<\/script>";var c=window.frames.contentToPrint;c.document.write("<head>"+d+'</head><body onload="window.print()">'+$("#projectModal .modal-content").html()+b+"</body>");c.document.close()};